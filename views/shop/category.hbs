<!--shop/category.hbs-->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div id="carousel">
            {{> carousel}}
            </div>
            <div class="row">
                <div class="col-sm-6 col-md-4 col-md-offset-4 col-sm-offset-3">
                    <div id="success" class="alert alert-success" {{#if noMessage}}hidden{{/if}}>
                        {{successMsg}}
                    </div>
                    <div id="danger" class="alert alert-danger" {{#if noErrorMsg}}hidden{{/if}}>
                        {{errorMsg}}
                    </div>
                </div>
            </div>
            {{>search}}
            <div class="row">
                <h2>Category: {{category.name}}</h2>
                <div class="panel-body">
                    <div class="dataTable_wrapper">
                        <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                            <thead>
                                <tr>
                                    <th><h3>Code</h3></th>
                                    <th><h3>Product</h3></th>
                                    <th><h3>Category</h3></th>
                                    <th><h3>Attributes</h3></th>
                                    <th><h3>Required</h3></th>
                                    <th><h3>Price</h3></th>
                                    <th><h3>Action</h3></th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each products}}
                                    <div class="row">
                                        {{# each this}}
                                            <tr class="odd gradeX">
                                                <form action="add-to-cart" method="POST">
                                                <input type='hidden' id='id' name='productId' value='{{ this._id }}'>
                                                <td>{{this.code}}</td>
                                                <td>{{this.name}}{{this.title}}</td>
                                                <td>{{this.category}}</td>
                                                <td>
                                                    {{#if this.Attributes}}
                                                        <ul>
                                                            {{#each this.Attributes}}
                                                                <li>{{this.Name}}: {{this.Value}}</li>
                                                            {{/each}}
                                                         </ul>
                                                    {{/if}}
                                                </td>
                                                <td>
                                                {{#if this.isTicket}}
                                                    <input type='hidden' id='price' name='price' value='{{ this.price }}'>
                                                    <input type='hidden' id='type' name='type' value='TICKET'>
                                                    <div class='form-group'>
                                                        <label for='Name'>Name for Ticket</label>
                                                        <input class='form-control input-sm' type='text' name='ticket_name' value="{{../../user.first_name}}">
                                                        <label for='Name'>Email</label>
                                                        <input class='form-control input-sm' type='text' name='ticket_email' value="{{../../user.email}}">
                                                    </div>
                                                {{else}}
                                                    {{#if this.isVariable}}
                                                        <input type='hidden' id='type' name='type' value='VARPRICE'>
                                                        <h3 class="product-price text-center">
                                                            <input type='text' class='text-right' name='price' value='{{this.price}}'>
                                                        </h3>
                                                    {{else}}
                                                        {{#if this.isApparel}}
                                                         <div class="form-group">
                                                            <input type='hidden' id='price' name='price' value='{{ this.price }}'>
                                                            <input type='hidden' id='type' name='type' value='APPAREL'>
                                                            <select class="form-control input-sm" name="option">
                                                                {{#each this.options}}
                                                                    <option name="{{value}}">{{name}}</option>
                                                                {{/each}}
                                                            </select>
                                                            </div>
                                                        {{else}}
                                                            No data required.
                                                        {{/if}}
                                                    {{/if}}
                                                {{/if}}
                                                </td>
                                                <td class="text-right"><h4>${{this.price}}</h4></td>
                                                <td class="center">
                                                    {{#if ../../isLoggedIn}}
                                                        <p class="text-center">
                                                            <input type='submit' value='Add to Cart' class="btn btn-success add-to-cart" role="button">
                                                        </p> 
                                                    {{else}}
                                                        <p class="text-center">
                                                            <a href="/user/signin" class="btn btn-primary add-to-cart" role="button">Sign in to Buy</a>
                                                        </p>
                                                    {{/if}}
                                                </td>
                                            </tr>
                                            </form>
                                        {{/each}}
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>